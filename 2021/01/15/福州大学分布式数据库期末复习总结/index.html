<!DOCTYPE html><html lang="default" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>福州大学分布式数据库期末复习总结 | 私人海域</title><meta name="description" content="第一章  1.2 分布式数据库的定义 &amp; 特性 **定义：**一个物理上分散而逻辑上集中的数据库系统 三个基本特点：a. 物理分布性  b. 逻辑整体性  c. 节点自治性 **其他特点：**d.数据分布透明性  e. 集中与自治相结合的控制机制  f. 适当的数据冗余度  g. 事务管理的分布性 分布式数据库系统的优点：  可以管理具有不同透明度的数据 提高可靠性和可用性：可靠性基本上"><meta name="keywords" content="资料"><meta name="author" content="Sonata,sonatau@163.com"><meta name="copyright" content="Sonata"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://tva1.sinaimg.cn/large/008i3skNly1gtytp9mlqyj60iz09y0sz02.jpg"><link rel="canonical" href="http://yluy.gitee.io/2021/01/15/%E7%A6%8F%E5%B7%9E%E5%A4%A7%E5%AD%A6%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0%E6%80%BB%E7%BB%93/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="福州大学分布式数据库期末复习总结"><meta property="og:url" content="http://yluy.gitee.io/2021/01/15/%E7%A6%8F%E5%B7%9E%E5%A4%A7%E5%AD%A6%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0%E6%80%BB%E7%BB%93/"><meta property="og:site_name" content="私人海域"><meta property="og:description" content="第一章  1.2 分布式数据库的定义 &amp; 特性 **定义：**一个物理上分散而逻辑上集中的数据库系统 三个基本特点：a. 物理分布性  b. 逻辑整体性  c. 节点自治性 **其他特点：**d.数据分布透明性  e. 集中与自治相结合的控制机制  f. 适当的数据冗余度  g. 事务管理的分布性 分布式数据库系统的优点：  可以管理具有不同透明度的数据 提高可靠性和可用性：可靠性基本上"><meta property="og:image" content="https://tva1.sinaimg.cn/large/008eGmZEly1gmo5j55vepj30qo0ezq6h.jpg"><meta property="article:published_time" content="2021-01-15T01:28:27.000Z"><meta property="article:modified_time" content="2021-01-15T02:05:53.409Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.0.2',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false    
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2021-01-15 10:05:53'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 5.0.2"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="https://tva1.sinaimg.cn/large/007S8ZIlly1ghwjow3dndj30jg0jgdgq.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">74</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">15</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">23</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0"><span class="toc-number">1.</span> <span class="toc-text"> 第一章</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%AE%9A%E4%B9%89-%E7%89%B9%E6%80%A7"><span class="toc-number">1.1.</span> <span class="toc-text"> 1.2 分布式数据库的定义 &amp; 特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E5%92%8C%E7%BB%84%E6%88%90%E6%88%90%E5%88%86"><span class="toc-number">1.2.</span> <span class="toc-text"> 1.3 分布式数据库系统体系结构和组成成分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-%E6%95%B0%E6%8D%AE%E7%8B%AC%E7%AB%8B%E6%80%A7-%E5%88%86%E5%B8%83%E9%80%8F%E6%98%8E%E6%80%A7"><span class="toc-number">1.3.</span> <span class="toc-text"> 1.4 数据独立性 &amp; 分布透明性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-ddbs%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.4.</span> <span class="toc-text"> 1.5 DDBS优缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0"><span class="toc-number">2.</span> <span class="toc-text"> 第二章</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#22-%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B%E8%AE%BE%E8%AE%A1%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">2.1.</span> <span class="toc-text"> 2.2 自顶向下设计分布式数据库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E6%9F%A5%E8%AF%A2%E5%A4%84%E7%90%86%E5%92%8C%E4%BC%98%E5%8C%96"><span class="toc-number">3.</span> <span class="toc-text"> 第三章 查询处理和优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#32-%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E5%9F%BA%E7%A1%80"><span class="toc-number">3.1.</span> <span class="toc-text"> 3.2 查询优化基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33-%E6%9F%A5%E8%AF%A2%E5%88%86%E7%B1%BB%E5%92%8C%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84"><span class="toc-number">3.2.</span> <span class="toc-text"> 3.3 查询分类和层次结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34-%E5%9F%BA%E4%BA%8E%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0%E7%AD%89%E4%BB%B7%E5%8F%98%E6%8D%A2%E7%9A%84%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E5%A4%84%E7%90%86"><span class="toc-number">3.3.</span> <span class="toc-text"> 3.4 基于关系代数等价变换的查询优化处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#35-%E5%9F%BA%E4%BA%8E%E5%8D%8A%E8%BF%9E%E6%8E%A5%E7%AE%97%E6%B3%95%E7%9A%84%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="toc-number">3.4.</span> <span class="toc-text"> 3.5 基于半连接算法的查询优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#36-%E5%9F%BA%E4%BA%8E%E7%9B%B4%E6%8E%A5%E8%BF%9E%E6%8E%A5%E7%AE%97%E6%B3%95%E7%9A%84%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="toc-number">3.5.</span> <span class="toc-text"> 3.6 基于直接连接算法的查询优化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%AB%A0"><span class="toc-number">4.</span> <span class="toc-text"> 第四章</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#41-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E6%A6%82%E8%BF%B0"><span class="toc-number">4.1.</span> <span class="toc-text"> 4.1 分布式事务概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#42-%E6%89%A7%E8%A1%8C%E4%B8%8E%E6%81%A2%E5%A4%8D"><span class="toc-number">4.2.</span> <span class="toc-text"> 4.2 执行与恢复</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%AB%A0"><span class="toc-number">5.</span> <span class="toc-text"> 第五章</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E5%85%AD%E7%AB%A0"><span class="toc-number">6.</span> <span class="toc-text"> 第六章</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://tva1.sinaimg.cn/large/008eGmZEly1gmo5j55vepj30qo0ezq6h.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">私人海域</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">福州大学分布式数据库期末复习总结</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2021-01-15T01:28:27.000Z" title="Created 2021-01-15 09:28:27">2021-01-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2021-01-15T02:05:53.409Z" title="Updated 2021-01-15 10:05:53">2021-01-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="第一章"><a class="markdownIt-Anchor" href="#第一章"></a> 第一章</h2>
<h3 id="12-分布式数据库的定义-特性"><a class="markdownIt-Anchor" href="#12-分布式数据库的定义-特性"></a> 1.2 分布式数据库的定义 &amp; 特性</h3>
<p>**定义：**一个物理上分散而逻辑上集中的数据库系统</p>
<p><strong>三个基本特点</strong>：a. 物理分布性  b. 逻辑整体性  c. 节点自治性</p>
<p>**其他特点：**d.数据分布透明性  e. 集中与自治相结合的控制机制  f. 适当的数据冗余度  g. 事务管理的分布性</p>
<p><strong>分布式数据库系统的优点：</strong></p>
<ul>
<li>可以管理具有不同透明度的数据</li>
<li>提高可靠性和可用性：可靠性基本上定义为系统在特定时间运行的概率，而可用性定义为系统在一段时间内连续可用的概率。当 数据和DBMS软件分布在多个站点上时，一个站点可能会失败而其他站点继续运行，并且我们无法仅访问故障站 点中存在的数据，这基本上可以提高可靠性和可用性。</li>
<li>更容易扩展<br />
在分布式环境中，在添加更多数据，增加数据库大小或添加更多数据方面扩展系统，增加数据库<br />
大小或添 加更多处理器要容易得多。</li>
<li>改进的性能<br />
通过将查询分解为基本上并行执行的多个子查询，我们可以通过在不同站点执行多个查询来实现<br />
查询间和 内部查询并行性，这基本上可以提高性能。</li>
</ul>
<p><strong>分布式数据库系统的挑战</strong>：数据独立性、数据冗余、查询优化、事务管理等</p>
<h3 id="13-分布式数据库系统体系结构和组成成分"><a class="markdownIt-Anchor" href="#13-分布式数据库系统体系结构和组成成分"></a> 1.3 分布式数据库系统体系结构和组成成分</h3>
<p><strong>DDBS体系结构</strong>：DB、DBMS、DBA，均分为全局和局部</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/91df2621-213f-4005-8fdd-61d755c2910b/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/91df2621-213f-4005-8fdd-61d755c2910b/Untitled.png" /></p>
<p><strong>DDB</strong>：DDB是DDBS中各站点上数据库的逻辑集合。</p>
<p><strong>DDB的模式结构：四层、六模式</strong></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8705a6d8-d41b-4e69-9700-389828d22bf5/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8705a6d8-d41b-4e69-9700-389828d22bf5/Untitled.png" /></p>
<p>a. 全局外层：全局外模式</p>
<p>b. 全局概念层：全局概念模式、分片模式、分配模式</p>
<p>c. 局部概念层：局部概念模式</p>
<p>d. 局部内层：局部内层</p>
<p>**分片模式：**描述全局数据的逻辑划分。数据存储的单位是数据的逻辑片段。每个全局关系可以通过选择和投影这样的关系操作被逻辑划分为若干个片段，这就是数据分片。分片模式就是描述数据分片或定义片段，以及全局关系与片段之间的映像。映像是一对多的，即一个全局关系可以对应多个片段，而一个片段只能来自于一个全局关系。</p>
<p>**分配模式：**描述数据片段的分配情况。定义片段映像的类型，确定分布式数据库是冗余的还是非冗余的，以及冗余的程度。如果一个片段分配在多个站点上，则片段的映像是一对多的，分布式数据库是冗余的。</p>
<p><strong>局部概念模式</strong>：对每个站点来说，在该站点上全部物理映像的集合称为该站点的局部概念模式。分配在同一站点上的同一个全局关系模式的一个或多个片段，构成了该全局关系模式在该站点上的一个物理映像。</p>
<h3 id="14-数据独立性-分布透明性"><a class="markdownIt-Anchor" href="#14-数据独立性-分布透明性"></a> 1.4 数据独立性 &amp; 分布透明性</h3>
<p><strong>数据独立性</strong> = 逻辑独立性 + 物理独立性 + 数据分布独立性</p>
<p><strong>分布透明性</strong>：包含三个层次，级别从高到低分别为分片透明性、位置透明性、局部数据模式透明性</p>
<p>a. 分片透明性：用户只需要关心全局关系模型，不必考虑数据的逻辑分片。位于全局概念模式和分片模式之间。（全局查询即可）</p>
<p>b. 位置透明性：各片段被复制的情况（是否被复制，复制了几个副本）、片段及各副本的节点位置分配情况。位于分片模式和分配模式之间。（精确到片段）</p>
<p>c. 局部数据模式透明性：与各个节点上数据库的数据模型无关。位于分配模式和局部概念模式之间。（精确到站点）</p>
<h3 id="15-ddbs优缺点"><a class="markdownIt-Anchor" href="#15-ddbs优缺点"></a> 1.5 DDBS优缺点</h3>
<p><strong>CDBS与DDBS的冗余比较</strong></p>
<p>a. CDBS：减少数据冗余，节省存储空间。其原因是，冗余数据不仅浪费空间，而且容易造成各数据副本之间的不一致性，为了保证数据的一致性，系统要付出一定的维护代价。</p>
<p>b. DDBS：最大特征是存在数据冗余，在不同的场地存储同一数据的多个副本。多重备份虽然损失掉了部分的存储空间，但保证了系统的可靠性和可用性。同时提高了系统性能，减少通信开销。</p>
<h2 id="第二章"><a class="markdownIt-Anchor" href="#第二章"></a> 第二章</h2>
<h3 id="22-自顶向下设计分布式数据库"><a class="markdownIt-Anchor" href="#22-自顶向下设计分布式数据库"></a> 2.2 自顶向下设计分布式数据库</h3>
<p><strong>自顶向下设计步骤</strong></p>
<p>需求分析 → 概念设计 → 逻辑设计 → <strong>分布设计</strong> → 物理设计</p>
<p>其中分布设计包括：a. 数据分片 b. 片段分配，其输入为全局模式，输出是局部概念模式。</p>
<p><strong>分片设计的基本内容</strong></p>
<p>a. 设计目的：合适的划分方案可以减少操作量，实现尽可能的本地性。</p>
<p>b. 分片三原则：1）完整性  2）可重构  3）不相交</p>
<p>c. 分片类型与其代数表达式：1）水平分片  2）垂直分片  3）混合分片</p>
<ul>
<li>
<p><strong>水平分片</strong>：对全局关系执行选择操作，把具有相同性质的元组进行分组，构成若干不相交的子集。</p>
<ul>
<li>
<p>初级分片：以关系自身的属性性质为基础，执行选择操作，将关系分片成若干个不相交的片段。谓词集合是完整的、最小的。</p>
</li>
<li>
<p>导出分片：从另一个关系的属性性质或水平片段推导出来的。导出分片是一种半连接操作。</p>
</li>
<li>
<p>代数表达式：</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ec2192c0-7b0a-48e6-a04e-a4301261f9ac/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ec2192c0-7b0a-48e6-a04e-a4301261f9ac/Untitled.png" /></p>
</li>
</ul>
</li>
<li>
<p><strong>垂直分片</strong>：对全局关系执行投影操作将属性分成若干组。垂直分片的组必须只在某个键属性上重叠，其他不能重叠。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e9759637-9103-4ea0-84e9-67bf235319f8/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e9759637-9103-4ea0-84e9-67bf235319f8/Untitled.png" /></p>
</li>
<li>
<p>**混合分片：**交替水平分片与垂直分片。</p>
</li>
</ul>
<p><strong>位置分配设计的基本内容</strong></p>
<p>在非冗余分配中，每个片段恰好映射到一个站点上；冗余分配中，每个片段映射到一个或多个站点上。</p>
<p>a. 非冗余分配：“最佳适应方法”，将片段R分配到访问R次数最多的那个站点上。</p>
<p>b. 冗余分配：“所有得益站点”法、“附加复制”法。</p>
<ul>
<li>所有得益站点法：应用的检索访问费用总比从任何一个其他站点发出的应用对R进行更新访问的费用要低。</li>
<li>附加复制法：从最有益处逐步附加复制的副本，直到附加复制已无明显好处。</li>
</ul>
<h2 id="第三章-查询处理和优化"><a class="markdownIt-Anchor" href="#第三章-查询处理和优化"></a> 第三章 查询处理和优化</h2>
<h3 id="32-查询优化基础"><a class="markdownIt-Anchor" href="#32-查询优化基础"></a> 3.2 查询优化基础</h3>
<p>**查询树：**对一个关系代数表达式表示的查询，进行语法分析，可以得到一颗语法树，树的叶子是已知的关系，各个节点是关系代数操作符。</p>
<p><strong>两个系统下的查询优化问题</strong></p>
<p>a. 集中式数据库系统中的查询优化：查询优化的目的在于为每个用户查询寻求总代价最小的执行策略，尽可能降低I/O代价,使查询的响应时间最短。</p>
<ul>
<li>逻辑优化:为每个用户查询寻求总代价最小的执行策略或最优的操作符次序;</li>
<li>物理优化:关于基本运算在实现中的优化,比如考虑索引、排序、聚集等。</li>
</ul>
<p>b. 分布式查询优化：两种不同的目标来考虑查询优化。</p>
<ul>
<li>一是以总代价最小为标准，除了如CDBS一样考虑CPU代价和I/O代价之外，总代价还包括通过网络在站点之间传输数据和信息的代价；数据的分布和冗余也增加了查询的并行处理的可能性</li>
<li>另一个目标是以每个查询的响应时间最短为标准。</li>
</ul>
<h3 id="33-查询分类和层次结构"><a class="markdownIt-Anchor" href="#33-查询分类和层次结构"></a> 3.3 查询分类和层次结构</h3>
<p><strong>查询处理步骤</strong>：查询分解 → 数据本地化 → 全局优化 → 局部优化</p>
<p>a. 查询分解：把SQL语句转换成一个定义在全局关系上的关系代数表达式。输入：sql语句；输出：关系代数表达式或全局查询树</p>
<p>b. 数据本地化：将一个在全局关系上的查询落实到合适的片段上。（全局查询树→片段查询树）</p>
<p>c. 全局优化：找出分片查询的最佳操作次序，使得代价最小。（片段查询树→优化的片段查询树）</p>
<p>d. 局部优化：采用集中式数据库系统中查询优化技术对片段查询进行优化处理。</p>
<h3 id="34-基于关系代数等价变换的查询优化处理"><a class="markdownIt-Anchor" href="#34-基于关系代数等价变换的查询优化处理"></a> 3.4 基于关系代数等价变换的查询优化处理</h3>
<p>**基本原理：**把查询问题转变为关系代数表达式,分析得到查询树，进行从全局到片段的变换得到基于片段上的查询树，然后利用关系代数等价变换规则的优化算法，尽可能先执行选择和投影操作。</p>
<p><strong>优化思想</strong>：利用关系代数等价变换规则,把查询树中的连接和合并操作尽可能上提(向树根方向)，选择和投影操作尽可能下移(向树叶方向)先进行。</p>
<p><strong>实现步骤和方法</strong></p>
<ul>
<li>将一个查询问题转变为关系代数表达式</li>
<li>从关系代数表达式转换为查询树</li>
<li>利用关系代数等价变换规则，对全局查询树进行优化处理</li>
<li>利用分片信息将全局查询树转换为片段上的查询树</li>
<li>再次利用关系代数等价变换规则，对片段查询树进行优化处理</li>
</ul>
<p><strong>从全局查询到片段查询优化原则</strong></p>
<p>a. **水平分片关系优化：**尽可能把选择条件下移到分片的限定关系处，再把分片的限定关系与选择条件进行比较，然后去掉它们之间存在矛盾的相应片段。如果最后剩下一个水平片段,则可去掉一个“并”操作。</p>
<p>b. <strong>垂直分片关系优化</strong>：把垂直分片所用到的属性集，与查询条件(查询表达式)中的投影操作所涉及的属性集相比较,去掉无关的垂直片段。如果最后剩下一个垂直片段，则可去掉一个“连接”操作。</p>
<h3 id="35-基于半连接算法的查询优化"><a class="markdownIt-Anchor" href="#35-基于半连接算法的查询优化"></a> 3.5 基于半连接算法的查询优化</h3>
<p><strong>从片段查询到物理查询的转换</strong></p>
<p>将片段查询树转换成具体的每个场地上的局部操作命令和数据传输命令序。其中操作执行次序的选择是重点！</p>
<p><strong>半连接操作</strong>：</p>
<p>a. 半连接操作具有不对称性</p>
<p>b. 从一个站点传送关系到另一个站点做连接之前，先出去那些与连接无关的数据，减少做连接操作的关系中的数据量，从而减少传输的代价。</p>
<p><strong>选择操作与半连接操作的不同点和相同点：</strong></p>
<ul>
<li>相同点：都是删减操作，都有过滤元组和选择元组的作用</li>
<li>不同点：选择操作是过滤，是单目运算；半连接操作是对半连接左边的进行缩减性运算，非对称的，是双目运算。</li>
<li>选择操作：以关系R上的选择操作为例。如果R是一个全局关系，那么简单地在包含R的站点上执行选择操作，然后把结果发送给用户站点。如果R被分片且分布在几个站点，那么在每个包含R片段的站点上执行选择操作，然后再将这些选择操作的结果合并到最终结果，发送给用户站点。</li>
<li>半连接操作：在从一个站点传送关系到另一个站点做连接实现之前，先除去那些与连接无关的数据，减少做连接操作的关系中的数据量，从而减少传输的代价。所以，如果只需要一个关系中的一小部分元组参与和另一个关系连接的话，这是一个使数据传输量最小化的非常有效的方案。</li>
</ul>
<p><strong>SDD-1算法</strong></p>
<p>a. 组成：基本算法 &amp; 后优化</p>
<p>b. 后优化算法的两条准则：</p>
<ul>
<li>若最后一次半连接程序缩减关系的所在场地恰好是被选中的查询执行场地，则最后一次半连接可以取消。</li>
<li>对基本算法的主迭代所构成的半连接程序程图进行修正。</li>
</ul>
<p>c. 基本算法：</p>
<ul>
<li>输入：优化了的片段查询树</li>
<li>方法
<ul>
<li>构造出所有可能的半连接缩减程序。</li>
<li>按半连接缩减程序的静态特性表分别计算其费用和收益，从一组可能的静态特性表中选取一个半连接程序，设M。</li>
<li>以M完成缩减后,又将产生一组新的静态特性再进行计算，再从一组可取的静态特性表中选一个半连接程序。</li>
<li>反复直到无半连接缩减程序为止。</li>
</ul>
</li>
<li>输出：以若干次迭代以后的最后缩减关系的静态特性表为基础,进行场地选择,决定执行查询的场地。</li>
</ul>
<p>d. 主要思路：利用半连接把属于两个场地的连接运算用半连接变成两次的传递，先缩减后连接，以便达到减少通信。</p>
<h3 id="36-基于直接连接算法的查询优化"><a class="markdownIt-Anchor" href="#36-基于直接连接算法的查询优化"></a> 3.6 基于直接连接算法的查询优化</h3>
<p>**分片和复制算法：**选择一组站点，把查询引用的某个关系的所有片段分布到这些站点上，其余被引用的关系则复制到每一个选定的站点中去。</p>
<p><strong>直接连接操作的常用策略</strong></p>
<p>a. 两个关系在同一站点----与CDBS中策略相同。<br />
b. 两个关系在不同站点----假设 R∞S</p>
<ul>
<li>第一种策略:整体传输</li>
<li>第二种策略:按需传输</li>
</ul>
<h2 id="第四章"><a class="markdownIt-Anchor" href="#第四章"></a> 第四章</h2>
<h3 id="41-分布式事务概述"><a class="markdownIt-Anchor" href="#41-分布式事务概述"></a> 4.1 分布式事务概述</h3>
<p>**集中式事务：**对数据库的一个或一段程序或命令的一次执行。</p>
<p>**分布式事务（全局事务）：**事务具有分布式，操作命令序列及数据分布在不同的站点上。通常由一个主事务和在不同站点上执行的子事务(局部事务)组成。</p>
<p><strong>主事务</strong>：负责事务的开始、提交和异常终止。</p>
<p><strong>子事务</strong>：完成对相应站点上数据库的访问操作。</p>
<p><strong>特性：</strong></p>
<p>a. 原子性：每个事务的所有操作要么被全部成功地执行，要么一个也不被执行。</p>
<p>b. 一致性：如果在执行事务之前数据库是一致的,那么在执行事务之后数据库也还是一致的。//可串行性。</p>
<p>c. 隔离性：即使多个事务并发执行,每个事务都感觉不到系统中有其他的事务在执行，因而也就能保证数据库的一致性。</p>
<p>d. 持久性：事务成功执行后它对数据库的修改是永久的，即使系统出现故障也不受影响。</p>
<p>分布式事务 = ACID + 分布，即各个站点上的数据库全都进入一个新的一致状态，才能使整个数据库转换为新的一致状态。</p>
<p><strong>全局提交原则</strong></p>
<p>a. 只要有一个参与者撤消事务,协调者就必须做出全局撤消决定;</p>
<p>b. 只有所有参与者都同意提交事务,协调者才能做出全局提交决定.</p>
<p><strong>分布式数据库中的故障类型</strong></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c25d4f10-9064-4b38-9ce2-f0fbe3e0b652/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/c25d4f10-9064-4b38-9ce2-f0fbe3e0b652/Untitled.png" /></p>
<p>其中比较主要的是：网络分割故障、报文错、报文失序。</p>
<h3 id="42-执行与恢复"><a class="markdownIt-Anchor" href="#42-执行与恢复"></a> 4.2 执行与恢复</h3>
<p><strong>日志记录格式：</strong></p>
<p>1)[start_transaction,T] 表示事务T开始执行;</p>
<p>2)[write_item,T,X,旧值,新值] 表示事务T已将数据项X的值从旧值该为新值;</p>
<p>3)[read_item,T,X] 表示事务T已读取数据项X的值;</p>
<p>4)[commit,T] 表示事务T已成功完成,其结果已被提交给数据库(永久性);</p>
<p>5)[abort,T] 表示事务T已被撤消;</p>
<p>6)Log:记录长度及用于恢复过程的辅助信息.</p>
<p>我们假设所有对数据库的永久改变都发生在事务内部,所以对事务故障进行恢复,实际上就是取消或重新逐个地执行日志中的事务操作.</p>
<p><strong>检查点工作原理：</strong></p>
<p>为了便于恢复,在日志中设定一种周期性操作点,称为检查点,以标始检查点前已执行完的事务是正确的.每遇检查点,就做如下工作:</p>
<p>1)将Log缓冲区内容写入日志数据集;</p>
<p>2)在日志数据集中写入这次检查点记录信息—当前活动事务表;</p>
<p>3)将DB缓冲区内容写入DB(更新当前DB);</p>
<p>4)将这次检查点记录在日志数据集中的地址记入“重启动文件”中.</p>
<p><strong>事务故障的恢复原则</strong></p>
<p>当发生事务故障时,为了保证事务的原子性需要进行事务恢复。事务故障主要是依靠日志来实现，恢复的原则是：</p>
<p>(1)孤立和逐步退出事务的原则<br />
对于不影响其它事务的可排除性局部故障,例如事务操作的删除、超时、违反完整性规则、资源、限制、死锁等,应令某个事务孤立和逐步地退出,将其所做过的修改恢复,即UNDO.</p>
<p>(2)成功结束事务原则<br />
成功结束事务所做过的修改应超越各种故障而存在,也就是重做(REDO)它所做过的所有修改数据库的操作.</p>
<p>(3)夭折事务的原则<br />
若发生了非局部性的不可排除的故障,例如系统崩溃,则撤消全部事务,恢复到初态.</p>
<p><strong>基于日志的事务故障的恢复处理过程</strong>：</p>
<p>在系统发生故障时，需要扫描日志，检查那些已在日志中写入[start_transaction,T]，但没有写入[commit,T]的所有事务T；恢复时必须回滚(UNDO)这些事务以取消它们对数据库的影响。</p>
<p>此外，还必须对日志中记录的已提交事务的所有写操作进行恢复，这样它们对数据库的作用才可根据这些记录重做(REDO)。</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/85bd2d21-a776-41f0-bd04-789fccceabb6/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/85bd2d21-a776-41f0-bd04-789fccceabb6/Untitled.png" /></p>
<p><strong>掌握两阶段提交协议内容（算法描述）、实现方式对故障的处理、阻塞现象；</strong></p>
<p>a. 两阶段提交协议：</p>
<ul>
<li>在两阶段提交协议中,把分布式事务的某一个代理(根代理)指定为协调者,所有其它代理称为参与者.</li>
<li>只有协调者才有掌握提交或撤消事务的决定权,而其他参与者各自负责在其本地数据库中执行写操作,并向协调者提出撤消或提交子事务的意向.</li>
<li>两个阶段：提交阶段 与 表决阶段</li>
<li>2PC协议保证了事务的原子性</li>
</ul>
<p>b. 算法描述</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0f5b6161-7e7f-4722-86ed-b62d47da4ab9/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/0f5b6161-7e7f-4722-86ed-b62d47da4ab9/Untitled.png" /></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dc762a83-b3a2-4b17-ae4f-9d70acab409b/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dc762a83-b3a2-4b17-ae4f-9d70acab409b/Untitled.png" /></p>
<p>c. 故障处理</p>
<ul>
<li>
<p>场地故障</p>
<p>(1)当一参与者在写入“准备提交”前发生故障时,该参与者无法向协调者发回答信息,因此,当协调者等待超时后,将决定中止事务.</p>
<p>对该故障场地而言,当故障恢复后,只要撤消该事务即可.</p>
<p>(2)参与者在写入“准备提交”后发生故障,这时,其它的参与者可以正常地结束该事务“提交”和“撤消”.</p>
<p>故障恢复后,该参与者要访问协调者或其它参与者,以了解事务已做出的决定,然后执行相应的操作.</p>
<p>(3)协调者在日志中写入“预提交”记录后,写入“全部提交”或“全部夭折”前发生故障,这时已发出“准备提交”信息的参与者将等待协调者恢复.</p>
<p>协调者重启动后将从头恢复提交协议,从“预提交”记录中读出参与者的标识符,重发“预提交”命令给参与者,重新执行提交过程.</p>
<p>(4)协调者在日志中写入“全部提交”或“全部夭折”记录后,在写入“完成”记录之前发生故障.</p>
<p>协调者恢复时必须给所有的参与者重发其决定.</p>
</li>
<li>
<p>丢失报文</p>
<p>(1)来自参与者的回答报文(准备提交或夭折)丢失了至少一个,此时,协调者将等待回答而超时,整个事务被夭折.</p>
<p>(2)丢失“预提交”报文,由于至少一个参与者收不到该命令,因此协调者会因等待参与者的回答而超时,整个事务被夭折.</p>
<p>(3)丢失“提交”或“夭折”报文,此时,参与者处于等待协调者命令的状态,当等待超时时,参与者将向协调者发送请求重发该命令的信息----需要在参与者中有超时机制.</p>
<p>(4)丢失“执行”报文,当协调者未收到全部的“执行”报文时,它会因等待而超时,此时,协调者重发命令给所有参与者----需要在协调者中有超时机制.</p>
</li>
</ul>
<p>d. 阻塞现象：</p>
<ul>
<li>在2PC协议中,当参与者等待协调者的回答时,可能因为网络故障或协调者故障使之收不到回答信息而出现等待超时。</li>
<li>这时,事务进入阻塞状态,重发“准备提交”信息要求协调者给予回答,直到故障恢复.若一直收不到回答,则事务一直处于阻塞状态而挂在相应的场地上。</li>
</ul>
<p><strong>2PC协议线性通信结构中报文、网络延迟的计算</strong></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be214c14-950a-49e4-9ce7-e28ad64d59c6/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/be214c14-950a-49e4-9ce7-e28ad64d59c6/Untitled.png" /></p>
<p><strong>非阻塞提交协议3PC协议以及该协议是如何避免阻塞现象的</strong></p>
<p>a. 原理</p>
<ul>
<li>在2PC协议中增加一段使得参与者的提交不仅要等到它知道所有的参与者均发出了“准备提交”的报文,而且还知道所有参与者的状态(如它们是处于故障状态,还是已经恢复)以后才执行,这时,2PC协议就是3PC协议。</li>
<li>在3PC协议中,报文有三次接收和发送.协调者第2次向参与者发出的报文不是“提交”报文,而是提交前的预备报文,告诉所有的参与者均可进入准备提交状态(第2态!),而参与者的回答也不是“提交”报文,而是“准备就绪”报文.</li>
<li>在2PC中,参与者在“等待回答”时有2种可能的情况,一是夭折,一是可以提交.后一种情况有可能出现阻塞。</li>
</ul>
<p>b. 3PC协议的工作过程:</p>
<ul>
<li>第一阶段,协调者向所有的参与者发“预提交”报文,由每个参与者根据自己的情况进行投票,只有收到所有的参与者均赞成提交的报文才进入下一阶段.</li>
<li>第二阶段,协调者向所有的参与者发“准备提交”报文,参与者收到该报文后若已经准备好提交,则回答“准备就绪”报文,否则进行夭折处理.</li>
<li>第三阶段,当协调者收到所有的参与者“准备就绪”的回答,就向所有的参与者发“提交”报文,参与者收到该报文后可以提交其子事务.</li>
</ul>
<p>c. 在3PC协议中下述两种状态是不相容的:</p>
<ul>
<li>一个参与者在其它任何一个参与者处于“赞成提交”状态(即第1状态)时,不可能进入“提交”状态(第3状态).</li>
<li>一个参与者在另一个参与者进入“提交”状态(第3状态),或任何一个参与者都进入了“准备提交”状态(第2状态)时不能进入“夭折”状态(第1状态).</li>
</ul>
<p>d. 3PC协议对故障的处理</p>
<ul>
<li>协调者没能及时发出“预提交”报文,导致参与者等待超时,这时,参与者将决定夭折.</li>
<li>协调者等待参与者的投票时超时,这时,协调者将决定夭折.</li>
<li>参与者已进入“赞成提交”状态(第1状态),在等待协调者的命令时超时或协调者故障.</li>
<li>参与者处于“准备就绪”状态(第2状态),等待协调者的提交命令超时.</li>
</ul>
<p><strong>3pc协议怎么比避免在2pc协议会出现的阻塞现象：</strong></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bb3c8f8d-9561-4fcc-8fb0-faea5f28a68a/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/bb3c8f8d-9561-4fcc-8fb0-faea5f28a68a/Untitled.png" /></p>
<h2 id="第五章"><a class="markdownIt-Anchor" href="#第五章"></a> 第五章</h2>
<p><strong>了解多个事务并发执行可能出现的问题</strong></p>
<ol>
<li>丢失更新问题</li>
<li>不一致分析问题</li>
<li>依赖于未提交更新的问题</li>
</ol>
<p><strong>了解并掌握并发控制的基本概念，比如事务调度、串行调度、可串行化调度、事务的冲突操作、一致性调度、基于冲突等价的等价调度等；</strong></p>
<ol>
<li>
<p>分布式事务的一个调度</p>
<p>Ti表示第i个事务,Ri(x)表示Ti对数据项x的读操作,Wi(x)表示Ti对数据项x的写操作.</p>
<p>所考虑的全部事务中的所有操作的一个序列称为这组事务的一个调度S.</p>
</li>
<li>
<p>串行调度</p>
<p>设有一组事务T={T1,T2,…,Tn},如果事务Ti的所有操作都先于事务Tj的操作,记为Ti&lt;Tj.</p>
<p>若一个调度S,其每个事务的执行均有Ti&lt;Tj,称S为串行调度,即S={…&lt;Ti&lt;Tj&lt;…}.</p>
</li>
<li>
<p>可串行化调度</p>
<p>与串行调度等价的调度称为可串行化调度.</p>
<p>直观上看,是让有冲突的操作串行执行,非冲突的操作并行执行.</p>
</li>
<li>
<p>冲突操作</p>
<p>如果有两个操作P和Q对同一个数据x进行操作,其中有一个是写操作W[x],则P和Q称为冲突操作.</p>
</li>
<li>
<p>一致性调度</p>
<p>如果执行一个调度S,使数据库从一个一致状态转变到另一个一致状态,则称调度S为一致性调度.</p>
<p>任何一个串行调度是一致性调度.</p>
</li>
<li>
<p>两个调度等价(冲突等价)</p>
<p>两个调度S1和S2是等价的充分条件是:对于两个有冲突的操作Oi和Oj,若：Oi,Oj Î S1,且Oi&lt;Oj,则Oi,Oj Î S2,且也有Oi&lt;Oj</p>
</li>
</ol>
<p>结论:</p>
<ul>
<li>同一个事务集上的可串行化调度,结果未必相同;</li>
<li>一个可串行化调度必定与某个串行调度等价,且是一致性调度;</li>
<li>一致性调度不一定是可串行化调度;</li>
<li>同一事务集的几个可串行化调度,它们的结果未必相同.<strong>使用优先图判别局部调度是否可串行化</strong></li>
</ul>
<p>使用优先图判别局部调度是否可串行化：</p>
<ul>
<li>对于调度S中的事务Ti,在图上创建一个节点Ti;</li>
<li>对于每一种这样的情形:如果S中在Ti执行了W(x)操作后执行Tj的R(x)操作,那么在优先图中创建一条边(Ti→Tj);</li>
<li>对于每一种这样的情形:如果S中在Ti执行了R(x)操作后执行Tj的W(x)操作,那么在优先图中创建一条边(Ti→Tj);</li>
<li>对于每一种这样的情形:如果S中在Ti执行了W(x)操作后执行Tj的W(x)操作,那么在优先图中创建一条边(Ti→Tj);</li>
<li>当且仅当优先图中没有环路时,调度S是可串行化的.</li>
</ul>
<p><strong>判别一个全局调度是否是一致性调度(全局可串行化调度的条件)：</strong></p>
<p>在分布式数据库中,只涉及一个站点上的调度称为局部调度,涉及多个站点，上的调度称为全局调度。</p>
<ul>
<li>如果分布式数据库中数据没有副本，并且每个局部调度都是可串行化的。那么它们的并集(即全局调度)也称作是可串行化的。</li>
<li>如果分布式数据库中数据有副本，当局部调度满足以下两个条件时，是可串行化的。
<ul>
<li>每一个局部调度必须是可串行化的;</li>
<li>两个冲突操作在它们同时出现的各个局部调度中,必须具有相同的相对顺序.</li>
</ul>
</li>
</ul>
<p><strong>两段锁协议</strong></p>
<ol>
<li>两阶段封锁协议保证调度的可串行化：如果一个事务所有的封锁操作都放在第一个解锁操作之前,那么就说该事务遵守两阶段封锁协议。这样的一个事务可以被分成两个阶段：
<ul>
<li>第一阶段是扩张或成长阶段.在这个阶段中,事务只能获得新的数据项锁,而不能释放任何已持有的锁.</li>
<li>第二阶段是收缩或衰退阶段.在这个阶段,事务只能释放已经持有的锁,而不能获得任何新的锁.</li>
</ul>
</li>
<li>工作过程（以严格2PL协议为例）:
<ul>
<li>当事务T发出R(X)的请求时,系统会代表T调用read-lock(X)操作。如果lock(X)的状态是被另一个事务T’持有写锁,那么,系统会把T放到数据项X的等待队列中。否则,系统同意read-lock(X)的请求,从而允许事务T执行R(X);</li>
<li>如果事务T发出W(X)操作的请求时,系统会代表T调用write-lock(X)操作。如果lock(X)的状态是被另一个事务T’持有读锁或写锁,那么,系统会把T放到数据项X的等待队列中。如果lock(X)的状态是读封锁,并且事务T本身就是持有X上的读锁的唯一事务,那么系统将该读锁升级为写锁,并且允许T执行W(X)的操作.</li>
</ul>
</li>
<li>缺点：
<ul>
<li>限制了一个调度中可以发生的并发事务的数量.</li>
<li>可能出现死锁.</li>
</ul>
</li>
</ol>
<p><strong>事务等待图和事务优先图的区别</strong></p>
<ol>
<li>事务等待图：一种用来表示事务之间相互等待关系的有向图，可指明哪个事务在等待别的事物释放锁</li>
<li>事务优先图：用于表示事务间先后次序，可以判断是否可串行化调度</li>
<li>等待图是动态的，有环路代表有死锁</li>
<li>优先图是静止的，有环路代表不可调度</li>
</ol>
<p>**死锁的判别：**当且仅当等待图中至少包含一个回路,则存在一个死锁。</p>
<p><strong>死锁的预防：</strong></p>
<ol>
<li>基本思想：当有发生死锁危险时,就中止并重新启动其中一个事务或让该事务等待。如果事务T1请求一资源,而该资源被另一事务T2所持有时,就进行一次预防性测试.若测试结果表明有死锁的危险时,或不让T1进入等待状态,并重新启动T1,或中止并重新启动T2.</li>
<li>方法：先对事务按它们的开始时间排序。
<ul>
<li>非占先权：总是重新启动比较年轻的事务,允许年老的事务等待年轻的。</li>
<li>占先权：要求中止比较年轻的事务,且允许年老的事务绝对优于年轻的事务,因而只有年轻的等待年老的。</li>
</ul>
</li>
</ol>
<p>死锁的检测和解决方法：</p>
<ul>
<li>检测: 通过对全局等待图中回路的形成进行研究来实现。</li>
<li>解决: 撤消某个/某些事务.选择撤消哪些事务称为受害者选择.通过选择一个或多个受害者事务，这些事务将被优先执行或撤消,以打破全局等待图中的回路。</li>
</ul>
<h2 id="第六章"><a class="markdownIt-Anchor" href="#第六章"></a> 第六章</h2>
<p><strong>数据可靠性的几种策略：读一写全法，多数法，主副本法</strong></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ffc7193e-d6f6-43f7-9bd1-9bf97b9bd7d4/Untitled.png" alt="https://s3-us-west-2.amazonaws.com/secure.notion-static.com/ffc7193e-d6f6-43f7-9bd1-9bf97b9bd7d4/Untitled.png" /></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:sonatau@163.com">Sonata</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yluy.gitee.io/2021/01/15/%E7%A6%8F%E5%B7%9E%E5%A4%A7%E5%AD%A6%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0%E6%80%BB%E7%BB%93/">http://yluy.gitee.io/2021/01/15/%E7%A6%8F%E5%B7%9E%E5%A4%A7%E5%AD%A6%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0%E6%80%BB%E7%BB%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%B5%84%E6%96%99/">资料</a></div><div class="post_share"><div class="social-share" data-image="https://tva1.sinaimg.cn/large/008eGmZEly1gmo5j55vepj30qo0ezq6h.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/01/15/%E3%80%90%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB%E3%80%91CVPR2019%E6%96%87%E6%9C%AC%E5%9B%BE%E5%83%8F%E7%94%9F%E6%88%90%E3%80%8ASDGAN%E3%80%8B/"><img class="prev-cover" data-lazy-src="https://tva1.sinaimg.cn/large/0081Kckwly1gm4jleprjlj30rs0ijmzf.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">【论文阅读】CVPR2019文本图像生成《SDGAN》</div></div></a></div><div class="next-post pull-right"><a href="/2020/12/30/%E3%80%90Leetcode%E6%AF%8F%E5%91%A8%E6%89%93%E5%8D%A1%E3%80%91%E7%AC%AC%E5%85%AD%E5%91%A8%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE%E4%B8%93%E9%A2%98/"><img class="next-cover" data-lazy-src="https://tva1.sinaimg.cn/large/0081Kckwly1gm65gqdhq6j31hc0u0tjn.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">【Leetcode每周打卡】第六周二分查找专题</div></div></a></div></nav></article></main><footer id="footer" style="background-image: url(https://tva1.sinaimg.cn/large/008eGmZEly1gmo5j55vepj30qo0ezq6h.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Sonata</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">hi there ~</div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="Increase Font Size"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="Decrease Font Size"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>$(function () {
  $('span.katex-display').wrap('<div class="katex-wrap"></div>')
})</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script defer="defer" id="ribbon_piao" mobile="false" src="/js/third-party/piao.js"></script><script src="/js/third-party/click_heart.js" async="async"></script></div></body></html>